
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>src.utilsSat &#8212; salomeTools 5.0.0dev documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for src.utilsSat</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#-*- coding:utf-8 -*-</span>

<span class="c1">#  Copyright (C) 2010-2018  CEA/DEN</span>
<span class="c1">#</span>
<span class="c1">#  This library is free software; you can redistribute it and/or</span>
<span class="c1">#  modify it under the terms of the GNU Lesser General Public</span>
<span class="c1">#  License as published by the Free Software Foundation; either</span>
<span class="c1">#  version 2.1 of the License.</span>
<span class="c1">#</span>
<span class="c1">#  This library is distributed in the hope that it will be useful,</span>
<span class="c1">#  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1">#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="c1">#  Lesser General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1">#  You should have received a copy of the GNU Lesser General Public</span>
<span class="c1">#  License along with this library; if not, write to the Free Software</span>
<span class="c1">#  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA</span>

<span class="sd">&quot;&quot;&quot;\</span>
<span class="sd">utilities for sat</span>
<span class="sd">general useful simple methods</span>
<span class="sd">all-in-one import srs.utilsSat as UTS</span>

<span class="sd">usage:</span>
<span class="sd">&gt;&gt; import srsc.utilsSat as UTS</span>
<span class="sd">&gt;&gt; UTS.ensure_path_exists(path)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">errno</span>
<span class="kn">import</span> <span class="nn">stat</span>

<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">tempfile</span>

<span class="kn">import</span> <span class="nn">src.returnCode</span> <span class="k">as</span> <span class="nn">RCO</span>
<span class="kn">import</span> <span class="nn">src.debug</span> <span class="k">as</span> <span class="nn">DBG</span> <span class="c1"># Easy print stderr (for DEBUG only)</span>


<span class="c1">##############################################################################</span>
<span class="c1"># file system utilities</span>
<span class="c1">##############################################################################</span>
<div class="viewcode-block" id="ensure_path_exists"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.ensure_path_exists">[docs]</a><span class="k">def</span> <span class="nf">ensure_path_exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a path if not existing</span>
<span class="sd">    </span>
<span class="sd">    :param path: (str) The path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># DBG.write(&quot;ensure_path_exists&quot;, path, True)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="replace_in_file"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.replace_in_file">[docs]</a><span class="k">def</span> <span class="nf">replace_in_file</span><span class="p">(</span><span class="n">file_in</span><span class="p">,</span> <span class="n">str_in</span><span class="p">,</span> <span class="n">str_out</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Replace &lt;str_in&gt; by &lt;str_out&gt; in file &lt;file_in&gt;</span>

<span class="sd">    :param file_in: (str) The file name</span>
<span class="sd">    :param str_in: (str) The string to search</span>
<span class="sd">    :param str_out: (str) The string to replace.    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_in</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> 
      <span class="n">contents</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">file_in</span><span class="p">,</span> <span class="n">file_in</span> <span class="o">+</span> <span class="s2">&quot;_old&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_in</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> 
      <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">contents</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">str_in</span><span class="p">,</span> <span class="n">str_out</span><span class="p">))</span></div>
  
<span class="c1">##############################################################################</span>
<span class="c1"># Utils class to simplify path manipulations.</span>
<span class="c1">##############################################################################</span>
<div class="viewcode-block" id="Path"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path">[docs]</a><span class="k">class</span> <span class="nc">Path</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">path</span>

<div class="viewcode-block" id="Path.exists"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.exists">[docs]</a>    <span class="k">def</span> <span class="nf">exists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">islink</span><span class="p">()</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="Path.islink"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.islink">[docs]</a>    <span class="k">def</span> <span class="nf">islink</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">islink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="Path.isdir"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.isdir">[docs]</a>    <span class="k">def</span> <span class="nf">isdir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="Path.isfile"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.isfile">[docs]</a>    <span class="k">def</span> <span class="nf">isfile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="Path.list"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.list">[docs]</a>    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)]</span></div>

<div class="viewcode-block" id="Path.dir"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.dir">[docs]</a>    <span class="k">def</span> <span class="nf">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">))</span></div>

<div class="viewcode-block" id="Path.base"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.base">[docs]</a>    <span class="k">def</span> <span class="nf">base</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">))</span></div>

<div class="viewcode-block" id="Path.make"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.make">[docs]</a>    <span class="k">def</span> <span class="nf">make</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>        
        <span class="k">if</span> <span class="n">mode</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="Path.chmod"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.chmod">[docs]</a>    <span class="k">def</span> <span class="nf">chmod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span></div>

<div class="viewcode-block" id="Path.rm"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.rm">[docs]</a>    <span class="k">def</span> <span class="nf">rm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>    
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">islink</span><span class="p">():</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">onerror</span> <span class="o">=</span> <span class="n">handleRemoveReadonly</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Path.copy"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">smart</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">Path</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">islink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copylink</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copydir</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">smart</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="Path.smartcopy"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.smartcopy">[docs]</a>    <span class="k">def</span> <span class="nf">smartcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Path.readlink"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.readlink">[docs]</a>    <span class="k">def</span> <span class="nf">readlink</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">islink</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">readlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Path.symlink"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.symlink">[docs]</a>    <span class="k">def</span> <span class="nf">symlink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">symlink</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Path.copylink"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.copylink">[docs]</a>    <span class="k">def</span> <span class="nf">copylink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">symlink</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">readlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Path.copydir"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.copydir">[docs]</a>    <span class="k">def</span> <span class="nf">copydir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">smart</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">dst</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="n">dst</span><span class="o">.</span><span class="n">make</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">dst</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">smart</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.git&quot;</span><span class="p">,</span> <span class="s2">&quot;CVS&quot;</span><span class="p">,</span> <span class="s2">&quot;.svn&quot;</span><span class="p">]):</span>
                    <span class="k">continue</span>
                <span class="n">srcname</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">name</span>
                <span class="n">dstname</span> <span class="o">=</span> <span class="n">dst</span> <span class="o">+</span> <span class="n">name</span>
                <span class="n">srcname</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">dstname</span><span class="p">,</span> <span class="n">smart</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Path.copyfile"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.Path.copyfile">[docs]</a>    <span class="k">def</span> <span class="nf">copyfile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div></div>

<div class="viewcode-block" id="find_file_in_lpath"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.find_file_in_lpath">[docs]</a><span class="k">def</span> <span class="nf">find_file_in_lpath</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">lpath</span><span class="p">,</span> <span class="n">additional_dir</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find in all the directories in lpath list the file </span>
<span class="sd">    that has the same name as file_name. </span>
<span class="sd">    If it is found, return the full path of the file, else, return False. </span>
<span class="sd">    The additional_dir (optional) is the name of the directory </span>
<span class="sd">    to add to all paths in lpath.</span>
<span class="sd">    </span>
<span class="sd">    :param file_name: (str) The file name to search</span>
<span class="sd">    :param lpath: (list) The list of directories where to search</span>
<span class="sd">    :param additional_dir: (str) The name of the additional directory</span>
<span class="sd">    :return: (str) The full path of the file or False if not found</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">lpath</span><span class="p">:</span>
        <span class="n">dir_complete</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">additional_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">dir_complete</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">l_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">dir_complete</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">file_n</span> <span class="ow">in</span> <span class="n">l_files</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">file_n</span> <span class="o">==</span> <span class="n">file_name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_complete</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="handleRemoveReadonly"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.handleRemoveReadonly">[docs]</a><span class="k">def</span> <span class="nf">handleRemoveReadonly</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">exc</span><span class="p">):</span>
    <span class="n">excvalue</span> <span class="o">=</span> <span class="n">exc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">func</span> <span class="ow">in</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">)</span> <span class="ow">and</span> <span class="n">excvalue</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errno</span><span class="o">.</span><span class="n">EACCES</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">stat</span><span class="o">.</span><span class="n">S_IRWXU</span><span class="o">|</span> <span class="n">stat</span><span class="o">.</span><span class="n">S_IRWXG</span><span class="o">|</span> <span class="n">stat</span><span class="o">.</span><span class="n">S_IRWXO</span><span class="p">)</span> <span class="c1"># 0777</span>
        <span class="n">func</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span></div>
        
<span class="c1">##############################################################################</span>
<span class="c1"># pyconf config utilities</span>
<span class="c1">##############################################################################</span>
        
<div class="viewcode-block" id="check_has_key"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.check_has_key">[docs]</a><span class="k">def</span> <span class="nf">check_has_key</span><span class="p">(</span><span class="n">inConfig</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check that the in-Config node has the named key (as an attribute) </span>
<span class="sd">    </span>
<span class="sd">    :param inConfig: (Config or Mapping etc) The in-Config node</span>
<span class="sd">    :param key: (str) The key to check presence in in-Config node</span>
<span class="sd">    :return: (RCO.ReturnCode) &#39;OK&#39; if presence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">debug</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inConfig</span><span class="p">:</span>
      <span class="n">msg</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;check_has_key &#39;</span><span class="si">%s</span><span class="s2">&#39; not found&quot;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
      <span class="n">DBG</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;check_has_key&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">debug</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">RCO</span><span class="o">.</span><span class="n">ReturnCode</span><span class="p">(</span><span class="s2">&quot;KO&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">msg</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;check_has_key &#39;</span><span class="si">%s</span><span class="s2">&#39; found&quot;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
      <span class="n">DBG</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;check_has_key&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">debug</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">RCO</span><span class="o">.</span><span class="n">ReturnCode</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span></div>
         
<div class="viewcode-block" id="check_config_has_application"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.check_config_has_application">[docs]</a><span class="k">def</span> <span class="nf">check_config_has_application</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check that the config has the key APPLICATION. </span>
<span class="sd">    Else raise an exception.</span>
<span class="sd">    </span>
<span class="sd">    :param config: (Config) The config.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;APPLICATION&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
      <span class="n">msg</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;An application name is required.&quot;</span><span class="p">)</span>
      <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;(as &#39;sat prepare &lt;application&gt;&#39;)&quot;</span><span class="p">)</span>
      <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Use &#39;sat config --list&#39; to get the list of available applications.&quot;</span><span class="p">)</span>
      <span class="n">DBG</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;check_config_has_application&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">RCO</span><span class="o">.</span><span class="n">ReturnCode</span><span class="p">(</span><span class="s2">&quot;KO&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">msg</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;APPLICATION &#39;</span><span class="si">%s</span><span class="s2">&#39; found.&quot;</span> <span class="o">%</span> <span class="n">config</span><span class="p">)</span>
      <span class="n">DBG</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;check_config_has_application&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">RCO</span><span class="o">.</span><span class="n">ReturnCode</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="check_config_has_profile"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.check_config_has_profile">[docs]</a><span class="k">def</span> <span class="nf">check_config_has_profile</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check that the config has the key APPLICATION.profile.</span>
<span class="sd">    Else, raise an exception.</span>
<span class="sd">    </span>
<span class="sd">    :param config: (Config) The config.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">check_config_has_application</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="o">.</span><span class="n">raiseIfKo</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;profile&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">APPLICATION</span><span class="p">:</span>
      <span class="n">msg</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;An &#39;APPLICATION.profile&#39; section is required in config.&quot;</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">RCO</span><span class="o">.</span><span class="n">ReturnCode</span><span class="p">(</span><span class="s2">&quot;KO&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">msg</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;An &#39;APPLICATION.profile&#39; is found in config.&quot;</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">RCO</span><span class="o">.</span><span class="n">ReturnCode</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="config_has_application"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.config_has_application">[docs]</a><span class="k">def</span> <span class="nf">config_has_application</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;APPLICATION&#39;</span> <span class="ow">in</span> <span class="n">config</span></div>

<div class="viewcode-block" id="get_cfg_param"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.get_cfg_param">[docs]</a><span class="k">def</span> <span class="nf">get_cfg_param</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">default</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Search for param_name value in config.</span>
<span class="sd">    If param_name is not in config, then return default,</span>
<span class="sd">    else, return the found value</span>
<span class="sd">       </span>
<span class="sd">    :param config: (Config) The config.</span>
<span class="sd">    :param param_name: (str) the name of the parameter to get the value</span>
<span class="sd">    :param default: (str) The value to return if param_name is not in config</span>
<span class="sd">    :return: (str) see initial description of the function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">param_name</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">config</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">default</span></div>

<div class="viewcode-block" id="get_base_path"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.get_base_path">[docs]</a><span class="k">def</span> <span class="nf">get_base_path</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the path of the products base.</span>
<span class="sd">    </span>
<span class="sd">    :param config: (Config) The global Config instance.</span>
<span class="sd">    :return: (str) The path of the products base.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;base&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">:</span>
        <span class="n">local_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">VARS</span><span class="o">.</span><span class="n">salometoolsway</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;local.pyconf&quot;</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Please define a base path in the file </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">local_file_path</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        
    <span class="n">base_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">LOCAL</span><span class="o">.</span><span class="n">base</span><span class="p">)</span>   
    <span class="k">return</span> <span class="n">base_path</span></div>

<div class="viewcode-block" id="get_launcher_name"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.get_launcher_name">[docs]</a><span class="k">def</span> <span class="nf">get_launcher_name</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the name of application file launcher, &#39;salome&#39; by default.</span>
<span class="sd">    </span>
<span class="sd">    :param config: (Config) The global Config instance.</span>
<span class="sd">    :return: (str) The name of salome launcher.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">check_config_has_application</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="o">.</span><span class="n">raiseIfKo</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;profile&#39;</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">APPLICATION</span> <span class="ow">and</span> \
       <span class="s1">&#39;launcher_name&#39;</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">APPLICATION</span><span class="o">.</span><span class="n">profile</span><span class="p">:</span>
        <span class="n">launcher_name</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">APPLICATION</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">launcher_name</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">launcher_name</span> <span class="o">=</span> <span class="s1">&#39;salome&#39;</span>
    <span class="k">return</span> <span class="n">launcher_name</span></div>


<div class="viewcode-block" id="get_log_path"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.get_log_path">[docs]</a><span class="k">def</span> <span class="nf">get_log_path</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the path of the logs.</span>
<span class="sd">    </span>
<span class="sd">    :param config: (Config) The global Config instance.</span>
<span class="sd">    :return: (str) The path of the logs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;log_dir&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">:</span>
        <span class="n">local_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">VARS</span><span class="o">.</span><span class="n">salometoolsway</span><span class="p">,</span>
                                      <span class="s2">&quot;data&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;local.pyconf&quot;</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Please define a log_dir in the file </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">local_file_path</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
      
    <span class="n">log_dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">LOCAL</span><span class="o">.</span><span class="n">log_dir</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">log_dir_path</span></div>

<div class="viewcode-block" id="get_salome_version"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.get_salome_version">[docs]</a><span class="k">def</span> <span class="nf">get_salome_version</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">APPLICATION</span><span class="p">,</span> <span class="s1">&#39;version_salome&#39;</span><span class="p">):</span>
        <span class="n">Version</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">APPLICATION</span><span class="o">.</span><span class="n">version_salome</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">KERNEL_info</span> <span class="o">=</span> <span class="n">product</span><span class="o">.</span><span class="n">get_product_config</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">&quot;KERNEL&quot;</span><span class="p">)</span>
        <span class="n">VERSION</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                            <span class="n">KERNEL_info</span><span class="o">.</span><span class="n">install_dir</span><span class="p">,</span>
                            <span class="s2">&quot;bin&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;salome&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;VERSION&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">VERSION</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
            
        <span class="n">fVERSION</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">VERSION</span><span class="p">)</span>
        <span class="n">Version</span> <span class="o">=</span> <span class="n">fVERSION</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">fVERSION</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
    <span class="n">VersionSalome</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">only_numbers</span><span class="p">(</span><span class="n">Version</span><span class="p">))</span>    
    <span class="k">return</span> <span class="n">VersionSalome</span></div>

<div class="viewcode-block" id="only_numbers"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.only_numbers">[docs]</a><span class="k">def</span> <span class="nf">only_numbers</span><span class="p">(</span><span class="n">str_num</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">nb</span> <span class="k">for</span> <span class="n">nb</span> <span class="ow">in</span> <span class="n">str_num</span> <span class="k">if</span> <span class="n">nb</span> <span class="ow">in</span> <span class="s1">&#39;0123456789&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="read_config_from_a_file"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.read_config_from_a_file">[docs]</a><span class="k">def</span> <span class="nf">read_config_from_a_file</span><span class="p">(</span><span class="n">filePath</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">cfg_file</span> <span class="o">=</span> <span class="n">pyconf</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">pyconf</span><span class="o">.</span><span class="n">ConfigError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Error in configuration file: </span><span class="si">%(file)s</span><span class="se">\n</span><span class="s2">  </span><span class="si">%(error)s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span>
            <span class="p">{</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="n">filePath</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="p">}</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">cfg_file</span></div>

<div class="viewcode-block" id="get_tmp_filename"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.get_tmp_filename">[docs]</a><span class="k">def</span> <span class="nf">get_tmp_filename</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">VARS</span><span class="o">.</span><span class="n">tmp_root</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">VARS</span><span class="o">.</span><span class="n">tmp_root</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">VARS</span><span class="o">.</span><span class="n">tmp_root</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="get_property_in_product_cfg"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.get_property_in_product_cfg">[docs]</a><span class="k">def</span> <span class="nf">get_property_in_product_cfg</span><span class="p">(</span><span class="n">product_cfg</span><span class="p">,</span> <span class="n">pprty</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="s2">&quot;properties&quot;</span> <span class="ow">in</span> <span class="n">product_cfg</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pprty</span> <span class="ow">in</span> <span class="n">product_cfg</span><span class="o">.</span><span class="n">properties</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">product_cfg</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">pprty</span><span class="p">]</span></div>

<span class="c1">##############################################################################</span>
<span class="c1"># logger utilities</span>
<span class="c1">##############################################################################</span>
<div class="viewcode-block" id="formatTuples"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.formatTuples">[docs]</a><span class="k">def</span> <span class="nf">formatTuples</span><span class="p">(</span><span class="n">tuples</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Format &#39;label = value&#39; the tuples in a tabulated way.</span>
<span class="sd">    </span>
<span class="sd">    :param tuples: (list) The list of tuples to format</span>
<span class="sd">    :return: (str) The tabulated text. (as mutiples lines)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># find the maximum length of the first value of the tuples</span>
    <span class="n">smax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">tuples</span><span class="p">))</span>
    <span class="c1"># Print each item of tuples with good indentation</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tuples</span><span class="p">:</span>
        <span class="n">sp</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">smax</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="n">sp</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> = </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># tuples, may be longer</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tuples</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="c1"># for long list</span>
    <span class="k">return</span> <span class="n">msg</span></div>
    
<div class="viewcode-block" id="formatValue"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.formatValue">[docs]</a><span class="k">def</span> <span class="nf">formatValue</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    format &#39;label = value&#39; with the info color</span>
<span class="sd">    </span>
<span class="sd">    :param label: (int) the label to print.</span>
<span class="sd">    :param value: (str) the value to print.</span>
<span class="sd">    :param suffix: (str) the optionnal suffix to add at the end.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;  </span><span class="si">%s</span><span class="s2"> = </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">suffix</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">msg</span></div>
    
<div class="viewcode-block" id="logger_info_tuples"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.logger_info_tuples">[docs]</a><span class="k">def</span> <span class="nf">logger_info_tuples</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="n">tuples</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For convenience</span>
<span class="sd">    format as formatTuples() and call logger.info()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">formatTuples</span><span class="p">(</span><span class="n">tuples</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="log_step"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.log_step">[docs]</a><span class="k">def</span> <span class="nf">log_step</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">))</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span></div>

<div class="viewcode-block" id="log_res_step"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.log_res_step">[docs]</a><span class="k">def</span> <span class="nf">log_res_step</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="n">res</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">res</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;&lt;OK&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;&lt;KO&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<span class="c1">##############################################################################</span>
<span class="c1"># color utilities, for convenience    </span>
<span class="c1">##############################################################################</span>
<span class="n">_colors</span> <span class="o">=</span> <span class="s2">&quot;BLACK RED GREEN YELLOW BLUE MAGENTA CYAN WHITE&quot;</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
    
<div class="viewcode-block" id="black"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.black">[docs]</a><span class="k">def</span> <span class="nf">black</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;black&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>

<div class="viewcode-block" id="red"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.red">[docs]</a><span class="k">def</span> <span class="nf">red</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;red&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>

<div class="viewcode-block" id="green"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.green">[docs]</a><span class="k">def</span> <span class="nf">green</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;green&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>

<div class="viewcode-block" id="yellow"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.yellow">[docs]</a><span class="k">def</span> <span class="nf">yellow</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;yellow&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>

<div class="viewcode-block" id="blue"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.blue">[docs]</a><span class="k">def</span> <span class="nf">blue</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;blue&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>

<div class="viewcode-block" id="magenta"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.magenta">[docs]</a><span class="k">def</span> <span class="nf">magenta</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;magenta&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>

<div class="viewcode-block" id="cyan"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.cyan">[docs]</a><span class="k">def</span> <span class="nf">cyan</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;cyan&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>

<div class="viewcode-block" id="white"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.white">[docs]</a><span class="k">def</span> <span class="nf">white</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;white&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>

<div class="viewcode-block" id="normal"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.normal">[docs]</a><span class="k">def</span> <span class="nf">normal</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;normal&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>

<div class="viewcode-block" id="reset"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.reset">[docs]</a><span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;reset&gt;&quot;</span><span class="o">+</span><span class="n">msg</span></div>

<div class="viewcode-block" id="info"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.info">[docs]</a><span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;info&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>

<div class="viewcode-block" id="header"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.header">[docs]</a><span class="k">def</span> <span class="nf">header</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;info&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>

<div class="viewcode-block" id="label"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.label">[docs]</a><span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;label&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>

<div class="viewcode-block" id="success"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.success">[docs]</a><span class="k">def</span> <span class="nf">success</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;success&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>

<div class="viewcode-block" id="warning"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.warning">[docs]</a><span class="k">def</span> <span class="nf">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;warning&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>

<div class="viewcode-block" id="error"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.error">[docs]</a><span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;error&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>

<div class="viewcode-block" id="critical"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.critical">[docs]</a><span class="k">def</span> <span class="nf">critical</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;critical&gt;&quot;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s2">&quot;&lt;reset&gt;&quot;</span></div>


<span class="c1">##############################################################################</span>
<span class="c1"># list and dict utilities</span>
<span class="c1">##############################################################################</span>
<div class="viewcode-block" id="deepcopy_list"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.deepcopy_list">[docs]</a><span class="k">def</span> <span class="nf">deepcopy_list</span><span class="p">(</span><span class="n">input_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Do a deep copy of a list</span>
<span class="sd">    </span>
<span class="sd">    :param input_list: (list) The list to copy</span>
<span class="sd">    :return: (list) The copy of the list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">input_list</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span></div>

<div class="viewcode-block" id="remove_item_from_list"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.remove_item_from_list">[docs]</a><span class="k">def</span> <span class="nf">remove_item_from_list</span><span class="p">(</span><span class="n">input_list</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove all occurences of item from input_list</span>
<span class="sd">    </span>
<span class="sd">    :param input_list: (list) The list to modify</span>
<span class="sd">    :return: (list) The without any item</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">input_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">elem</span> <span class="o">==</span> <span class="n">item</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span></div>

<div class="viewcode-block" id="merge_dicts"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.merge_dicts">[docs]</a><span class="k">def</span> <span class="nf">merge_dicts</span><span class="p">(</span><span class="o">*</span><span class="n">dict_args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given any number of dicts, shallow copy and merge into a new dict,</span>
<span class="sd">    precedence goes to key value pairs in latter dicts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">dict_args</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span></div>
    
    
<span class="c1">##############################################################################</span>
<span class="c1"># date utilities</span>
<span class="c1">##############################################################################</span>
<div class="viewcode-block" id="parse_date"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.parse_date">[docs]</a><span class="k">def</span> <span class="nf">parse_date</span><span class="p">(</span><span class="n">date</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Transform YYYYMMDD_hhmmss into YYYY-MM-DD hh:mm:ss.</span>
<span class="sd">    </span>
<span class="sd">    :param date: (str) The date to transform</span>
<span class="sd">    :return: (str) The date in the new format</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">15</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">date</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">date</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span>
                                 <span class="n">date</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span>
                                 <span class="n">date</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span>
                                 <span class="n">date</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span>
                                 <span class="n">date</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">13</span><span class="p">],</span>
                                 <span class="n">date</span><span class="p">[</span><span class="mi">13</span><span class="p">:])</span>
    <span class="k">return</span> <span class="n">res</span></div>


<span class="c1">##############################################################################</span>
<span class="c1"># log utilities (TODO: set in loggingSat class, later, changing tricky xml?</span>
<span class="c1">##############################################################################    </span>
<div class="viewcode-block" id="date_to_datetime"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.date_to_datetime">[docs]</a><span class="k">def</span> <span class="nf">date_to_datetime</span><span class="p">(</span><span class="n">date</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    From a string date in format YYYYMMDD_HHMMSS</span>
<span class="sd">    returns list year, mon, day, hour, minutes, seconds </span>
<span class="sd">    </span>
<span class="sd">    :param date: (str) The date in format YYYYMMDD_HHMMSS</span>
<span class="sd">    :return: (tuple) as (str,str,str,str,str,str)</span>
<span class="sd">      The same date and time in separate variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">date</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">date</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">dd</span> <span class="o">=</span> <span class="n">date</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">date</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">date</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">date</span><span class="p">[</span><span class="mi">13</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">Y</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">dd</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">S</span></div>

<div class="viewcode-block" id="timedelta_total_seconds"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.timedelta_total_seconds">[docs]</a><span class="k">def</span> <span class="nf">timedelta_total_seconds</span><span class="p">(</span><span class="n">timedelta</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replace total_seconds from datetime module </span>
<span class="sd">    in order to be compatible with old python versions</span>
<span class="sd">    </span>
<span class="sd">    :param timedelta: (datetime.timedelta) </span>
<span class="sd">      The delta between two dates</span>
<span class="sd">    :return: (float) </span>
<span class="sd">      The number of seconds corresponding to timedelta.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">timedelta</span><span class="o">.</span><span class="n">microseconds</span> <span class="o">+</span> <span class="mf">0.0</span> <span class="o">+</span>
        <span class="p">(</span><span class="n">timedelta</span><span class="o">.</span><span class="n">seconds</span> <span class="o">+</span> <span class="n">timedelta</span><span class="o">.</span><span class="n">days</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">6</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">6</span></div>
        
<span class="n">_log_macro_command_file_expression</span> <span class="o">=</span> <span class="s2">&quot;^[0-9]</span><span class="si">{8}</span><span class="s2">_+[0-9]</span><span class="si">{6}</span><span class="s2">_+.*\.xml$&quot;</span>
<span class="n">_log_all_command_file_expression</span> <span class="o">=</span> <span class="s2">&quot;^.*[0-9]</span><span class="si">{8}</span><span class="s2">_+[0-9]</span><span class="si">{6}</span><span class="s2">_+.*\.xml$&quot;</span>

<div class="viewcode-block" id="show_command_log"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.show_command_log">[docs]</a><span class="k">def</span> <span class="nf">show_command_log</span><span class="p">(</span><span class="n">logFilePath</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">application</span><span class="p">,</span> <span class="n">notShownCommands</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used in updateHatXml. </span>
<span class="sd">    Determine if the log xml file logFilePath </span>
<span class="sd">    has to be shown or not in the hat log.</span>
<span class="sd">    </span>
<span class="sd">    :param logFilePath: (str) the path to the command xml log file</span>
<span class="sd">    :param cmd: (str) the command of the log file</span>
<span class="sd">    :param application: (str) </span>
<span class="sd">      The application passed as parameter to the salomeTools command</span>
<span class="sd">    :param notShownCommands: (list) </span>
<span class="sd">      The list of commands that are not shown by default</span>
<span class="sd">    :return: (RCO.ReturnCode)</span>
<span class="sd">      OK if cmd is not in notShownCommands and the application </span>
<span class="sd">      in the log file corresponds to application</span>
<span class="sd">      ReturnCode value is tuple (appliLog, launched_cmd)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># When the command is not in notShownCommands, no need to go further :</span>
    <span class="c1"># Do not show</span>
    
    <span class="kn">import</span> <span class="nn">src.xmlManager</span> <span class="k">as</span> <span class="nn">XMLMGR</span> <span class="c1"># avoid import cross utilsSat</span>
    
    <span class="k">if</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">notShownCommands</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">RCO</span><span class="o">.</span><span class="n">ReturnCode</span><span class="p">(</span><span class="s2">&quot;KO&quot;</span><span class="p">,</span> <span class="s2">&quot;command &#39;</span><span class="si">%s</span><span class="s2">&#39; in notShownCommands&quot;</span> <span class="o">%</span> <span class="n">cmd</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
 
    <span class="c1"># Get the application of the log file</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">logFileXml</span> <span class="o">=</span> <span class="n">XMLMGR</span><span class="o">.</span><span class="n">ReadXmlFile</span><span class="p">(</span><span class="n">logFilePath</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;The log file &#39;</span><span class="si">%s</span><span class="s2">&#39; cannot be read&quot;</span> <span class="o">%</span> <span class="n">logFilePath</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">RCO</span><span class="o">.</span><span class="n">ReturnCode</span><span class="p">(</span><span class="s2">&quot;KO&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">&#39;application&#39;</span> <span class="ow">in</span> <span class="n">logFileXml</span><span class="o">.</span><span class="n">xmlroot</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">appliLog</span> <span class="o">=</span> <span class="n">logFileXml</span><span class="o">.</span><span class="n">xmlroot</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;application&#39;</span><span class="p">)</span>
        <span class="n">launched_cmd</span> <span class="o">=</span> <span class="n">logFileXml</span><span class="o">.</span><span class="n">xmlroot</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Site&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;launchedCommand&#39;</span><span class="p">]</span>
        <span class="c1"># if it corresponds, then the log has to be shown</span>
        <span class="k">if</span> <span class="n">appliLog</span> <span class="o">==</span> <span class="n">application</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">RCO</span><span class="o">.</span><span class="n">ReturnCode</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="s2">&quot;appliLog is application&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">appliLog</span><span class="p">,</span> <span class="n">launched_cmd</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">application</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">RCO</span><span class="o">.</span><span class="n">ReturnCode</span><span class="p">(</span><span class="s2">&quot;KO&quot;</span><span class="p">,</span> <span class="s2">&quot;application is not &#39;None&#39;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">appliLog</span><span class="p">,</span> <span class="n">launched_cmd</span><span class="p">))</span>
        
        <span class="k">return</span> <span class="n">RCO</span><span class="o">.</span><span class="n">ReturnCode</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">appliLog</span><span class="p">,</span> <span class="n">launched_cmd</span><span class="p">))</span>
    
    <span class="k">if</span> <span class="n">application</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">RCO</span><span class="o">.</span><span class="n">ReturnCode</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="s2">&quot;application == &#39;None&#39;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">RCO</span><span class="o">.</span><span class="n">ReturnCode</span><span class="p">(</span><span class="s2">&quot;KO&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span></div>

<div class="viewcode-block" id="list_log_file"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.list_log_file">[docs]</a><span class="k">def</span> <span class="nf">list_log_file</span><span class="p">(</span><span class="n">dirPath</span><span class="p">,</span> <span class="n">expression</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Find all files corresponding to expression in dirPath</span>
<span class="sd">    </span>
<span class="sd">    :param dirPath: (str) the directory where to search the files</span>
<span class="sd">    :param expression: (str) the regular expression of files to find</span>
<span class="sd">    :return: (list) the list of files path and informations about it</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lRes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">fileName</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">dirPath</span><span class="p">):</span>
        <span class="c1"># YYYYMMDD_HHMMSS_namecmd.xml</span>
        <span class="n">sExpr</span> <span class="o">=</span> <span class="n">expression</span>
        <span class="n">oExpr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">sExpr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">oExpr</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">fileName</span><span class="p">):</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">fileName</span>
            <span class="k">if</span> <span class="n">fileName</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;micro_&quot;</span><span class="p">):</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">fileName</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;micro_&quot;</span><span class="p">):]</span>
            <span class="c1"># get date and hour and format it</span>
            <span class="n">date_hour_cmd_host</span> <span class="o">=</span> <span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="n">date_not_formated</span> <span class="o">=</span> <span class="n">date_hour_cmd_host</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">date</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">date_not_formated</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> 
                                 <span class="n">date_not_formated</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span> 
                                 <span class="n">date_not_formated</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
            <span class="n">hour_not_formated</span> <span class="o">=</span> <span class="n">date_hour_cmd_host</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">hour</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">hour_not_formated</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> 
                                 <span class="n">hour_not_formated</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> 
                                 <span class="n">hour_not_formated</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">date_hour_cmd_host</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="n">date_hour_cmd_host</span><span class="p">[</span><span class="mi">2</span><span class="p">][:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;.xml&#39;</span><span class="p">)]</span>
                <span class="n">host</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="n">date_hour_cmd_host</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">host</span> <span class="o">=</span> <span class="n">date_hour_cmd_host</span><span class="p">[</span><span class="mi">3</span><span class="p">][:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;.xml&#39;</span><span class="p">)]</span>
            <span class="n">lRes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirPath</span><span class="p">,</span> <span class="n">fileName</span><span class="p">),</span> 
                         <span class="n">date_not_formated</span><span class="p">,</span>
                         <span class="n">date</span><span class="p">,</span>
                         <span class="n">hour_not_formated</span><span class="p">,</span>
                         <span class="n">hour</span><span class="p">,</span>
                         <span class="n">cmd</span><span class="p">,</span>
                         <span class="n">host</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">lRes</span></div>

<div class="viewcode-block" id="update_hat_xml"><a class="viewcode-back" href="../../apidoc_src/src.html#src.utilsSat.update_hat_xml">[docs]</a><span class="k">def</span> <span class="nf">update_hat_xml</span><span class="p">(</span><span class="n">logDir</span><span class="p">,</span> <span class="n">application</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">notShownCommands</span> <span class="o">=</span> <span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create the xml file in logDir that contain all the xml file </span>
<span class="sd">    and have a name like YYYYMMDD_HHMMSS_namecmd.xml</span>
<span class="sd">    </span>
<span class="sd">    :param logDir: (str) the directory to parse</span>
<span class="sd">    :param application: (str) the name of the application if there is any</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create an instance of XmlLogFile class to create hat.xml file</span>
    
    <span class="kn">import</span> <span class="nn">src.xmlManager</span> <span class="k">as</span> <span class="nn">XMLMGR</span> <span class="c1"># avoid import cross utilsSat </span>
    
    <span class="n">xmlHatFilePath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">logDir</span><span class="p">,</span> <span class="s1">&#39;hat.xml&#39;</span><span class="p">)</span>
    <span class="n">xmlHat</span> <span class="o">=</span> <span class="n">XMLMGR</span><span class="o">.</span><span class="n">XmlLogFile</span><span class="p">(</span><span class="n">xmlHatFilePath</span><span class="p">,</span> <span class="s2">&quot;LOGlist&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;application&quot;</span> <span class="p">:</span> <span class="n">application</span><span class="p">})</span>
    <span class="c1"># parse the log directory to find all the command logs, </span>
    <span class="c1"># then add it to the xml file</span>
    <span class="n">lLogFile</span> <span class="o">=</span> <span class="n">list_log_file</span><span class="p">(</span><span class="n">logDir</span><span class="p">,</span> <span class="n">_log_macro_command_file_expression</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">filePath</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">__</span> <span class="ow">in</span> <span class="n">lLogFile</span><span class="p">:</span>
        <span class="n">showLog</span><span class="p">,</span> <span class="n">cmdAppli</span><span class="p">,</span> <span class="n">full_cmd</span> <span class="o">=</span> <span class="n">show_command_log</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span>
                                              <span class="n">application</span><span class="p">,</span> <span class="n">notShownCommands</span><span class="p">)</span>
        <span class="c1">#if cmd not in notShownCommands:</span>
        <span class="k">if</span> <span class="n">showLog</span><span class="p">:</span>
            <span class="c1"># add a node to the hat.xml file</span>
            <span class="n">xmlHat</span><span class="o">.</span><span class="n">add_simple_node</span><span class="p">(</span><span class="s2">&quot;LogCommand&quot;</span><span class="p">,</span> 
                                   <span class="n">text</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filePath</span><span class="p">),</span> 
                                   <span class="n">attrib</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;date&quot;</span> <span class="p">:</span> <span class="n">date</span><span class="p">,</span> 
                                             <span class="s2">&quot;hour&quot;</span> <span class="p">:</span> <span class="n">hour</span><span class="p">,</span> 
                                             <span class="s2">&quot;cmd&quot;</span> <span class="p">:</span> <span class="n">cmd</span><span class="p">,</span> 
                                             <span class="s2">&quot;application&quot;</span> <span class="p">:</span> <span class="n">cmdAppli</span><span class="p">,</span>
                                             <span class="s2">&quot;full_command&quot;</span> <span class="p">:</span> <span class="n">full_cmd</span><span class="p">})</span>
    
    <span class="c1"># Write the file on the hard drive</span>
    <span class="n">xmlHat</span><span class="o">.</span><span class="n">write_tree</span><span class="p">(</span><span class="s1">&#39;hat.xsl&#39;</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/sat_v5.0.png" alt="Logo"/>
            </a></p><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, CEA.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>